<!DOCTYPE html>
<html lang="de" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0a">
    <title>AuditPro 2025 - Amazon WHS SIFA</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="/manifest.json">
    
    <!-- External Dependencies -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <div class="logo-animation">
                <i class="fas fa-shield-check"></i>
            </div>
            <h1>AuditPro 2025</h1>
            <div class="loading-bar"></div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Navigation Bar -->
        <nav class="nav-bar">
            <div class="nav-content">
                <div class="nav-brand">
                    <i class="fas fa-shield-check"></i>
                    <span>AuditPro</span>
                </div>
                <div class="nav-menu">
                    <button class="nav-item active" data-page="dashboard">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </button>
                    <button class="nav-item" data-page="audits">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Audits</span>
                    </button>
                    <button class="nav-item" data-page="templates">
                        <i class="fas fa-file-alt"></i>
                        <span>Templates</span>
                    </button>
                    <button class="nav-item" data-page="analytics">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics</span>
                    </button>
                    <button class="nav-item" data-page="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </button>
                </div>
                <div class="nav-user">
                    <div class="connection-status" id="connection-status">
                        <i class="fas fa-wifi"></i>
                    </div>
                    <div class="user-avatar" id="user-menu-trigger">
                        <img src="https://ui-avatars.com/api/?name=User&background=3b82f6&color=fff" alt="User">
                        <span class="user-name">Auditor</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page active">
                <div class="page-header">
                    <h1>Dashboard</h1>
                    <button class="btn btn-primary" id="start-audit-btn">
                        <i class="fas fa-plus"></i>
                        Neue Begehung starten
                    </button>
                </div>
                
                <div class="dashboard-grid">
                    <!-- Quick Stats -->
                    <div class="stat-cards">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Heute</h3>
                                <p class="stat-value">0</p>
                                <span class="stat-label">Begehungen</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Offene Mängel</h3>
                                <p class="stat-value">0</p>
                                <span class="stat-label">Zu beheben</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Compliance</h3>
                                <p class="stat-value">100%</p>
                                <span class="stat-label">Diese Woche</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Ø Zeit</h3>
                                <p class="stat-value">0m</p>
                                <span class="stat-label">Pro Begehung</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Audits -->
                    <div class="recent-audits">
                        <h2>Letzte Begehungen</h2>
                        <div id="recent-audits-list" class="audit-list">
                            <div class="empty-state">
                                <i class="fas fa-clipboard-list"></i>
                                <p>Keine Begehungen vorhanden</p>
                            </div>
                        </div>
                    </div>

                    <!-- Station Overview -->
                    <div class="station-overview">
                        <h2>Stationen Übersicht</h2>
                        <div class="station-grid">
                            <div class="station-card" data-station="DVI1">
                                <h3>DVI1</h3>
                                <div class="station-status">
                                    <span class="status-indicator status-good"></span>
                                    <span>Gut</span>
                                </div>
                                <p class="last-audit">Keine Daten</p>
                            </div>
                            <div class="station-card" data-station="DVI2">
                                <h3>DVI2</h3>
                                <div class="station-status">
                                    <span class="status-indicator status-good"></span>
                                    <span>Gut</span>
                                </div>
                                <p class="last-audit">Keine Daten</p>
                            </div>
                            <div class="station-card" data-station="DVI3">
                                <h3>DVI3</h3>
                                <div class="station-status">
                                    <span class="status-indicator status-good"></span>
                                    <span>Gut</span>
                                </div>
                                <p class="last-audit">Keine Daten</p>
                            </div>
                            <div class="station-card" data-station="DAP5">
                                <h3>DAP5</h3>
                                <div class="station-status">
                                    <span class="status-indicator status-good"></span>
                                    <span>Gut</span>
                                </div>
                                <p class="last-audit">Keine Daten</p>
                            </div>
                            <div class="station-card" data-station="DAP8">
                                <h3>DAP8</h3>
                                <div class="station-status">
                                    <span class="status-indicator status-good"></span>
                                    <span>Gut</span>
                                </div>
                                <p class="last-audit">Keine Daten</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Audits Page -->
            <div id="audits-page" class="page">
                <div class="page-header">
                    <h1>Begehungen</h1>
                    <div class="header-actions">
                        <input type="search" class="search-input" placeholder="Suchen..." id="audit-search">
                        <button class="btn btn-secondary" id="filter-btn">
                            <i class="fas fa-filter"></i>
                            Filter
                        </button>
                    </div>
                </div>
                
                <div id="audits-list" class="audits-container">
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <p>Keine Begehungen gefunden</p>
                    </div>
                </div>
            </div>

            <!-- Templates Page -->
            <div id="templates-page" class="page">
                <div class="page-header">
                    <h1>Vorlagen</h1>
                    <button class="btn btn-primary" id="create-template-btn">
                        <i class="fas fa-plus"></i>
                        Neue Vorlage
                    </button>
                </div>
                
                <div class="templates-grid" id="templates-list">
                    <!-- Templates will be loaded here -->
                </div>
            </div>

            <!-- Analytics Page -->
            <div id="analytics-page" class="page">
                <div class="page-header">
                    <h1>Analytics</h1>
                    <div class="date-range-picker">
                        <button class="btn btn-secondary">
                            <i class="fas fa-calendar"></i>
                            Letzte 30 Tage
                        </button>
                    </div>
                </div>
                
                <div class="analytics-container">
                    <div class="chart-container">
                        <h2>Compliance Trend</h2>
                        <canvas id="compliance-chart"></canvas>
                    </div>
                    <div class="insights-container">
                        <h2>AI Insights</h2>
                        <div class="insight-cards">
                            <div class="insight-card">
                                <i class="fas fa-lightbulb"></i>
                                <p>Keine Insights verfügbar</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings-page" class="page">
                <div class="page-header">
                    <h1>Einstellungen</h1>
                </div>
                
                <div class="settings-container">
                    <div class="settings-section">
                        <h2>Profil</h2>
                        <div class="setting-item">
                            <label>Name</label>
                            <input type="text" id="auditor-name" class="form-input" placeholder="Ihr Name">
                        </div>
                        <div class="setting-item">
                            <label>E-Mail</label>
                            <input type="email" id="auditor-email" class="form-input" placeholder="ihre.email@amazon.com">
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h2>App Einstellungen</h2>
                        <div class="setting-item">
                            <label>Offline Modus</label>
                            <label class="toggle">
                                <input type="checkbox" id="offline-mode">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>Spracheingabe</label>
                            <label class="toggle">
                                <input type="checkbox" id="voice-input">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>Automatische Synchronisierung</label>
                            <label class="toggle">
                                <input type="checkbox" id="auto-sync" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h2>Daten</h2>
                        <button class="btn btn-secondary" id="export-data-btn">
                            <i class="fas fa-download"></i>
                            Alle Daten exportieren
                        </button>
                        <button class="btn btn-danger" id="clear-data-btn">
                            <i class="fas fa-trash"></i>
                            Lokale Daten löschen
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- New Audit Modal -->
    <div id="new-audit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Neue Begehung</h2>
                <button class="modal-close" data-modal="new-audit-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="new-audit-form">
                    <div class="form-group">
                        <label>Station</label>
                        <select id="audit-station" class="form-input" required>
                            <option value="">Wählen Sie eine Station</option>
                            <option value="DVI1">DVI1</option>
                            <option value="DVI2">DVI2</option>
                            <option value="DVI3">DVI3</option>
                            <option value="DAP5">DAP5</option>
                            <option value="DAP8">DAP8</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Vorlage</label>
                        <select id="audit-template" class="form-input" required>
                            <option value="">Wählen Sie eine Vorlage</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Zusätzliche Auditoren (optional)</label>
                        <input type="text" id="additional-auditors" class="form-input" placeholder="Name1, Name2, ...">
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" data-modal="new-audit-modal">Abbrechen</button>
                        <button type="submit" class="btn btn-primary">Begehung starten</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Audit Execution Modal -->
    <div id="audit-execution-modal" class="modal fullscreen">
        <div class="modal-content">
            <div class="audit-header">
                <div class="audit-info">
                    <h2 id="audit-title">Begehung</h2>
                    <span id="audit-progress">0 / 0</span>
                </div>
                <div class="audit-actions">
                    <button class="btn btn-icon" id="voice-record-btn" title="Spracheingabe">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <button class="btn btn-icon" id="save-draft-btn" title="Entwurf speichern">
                        <i class="fas fa-save"></i>
                    </button>
                    <button class="btn btn-secondary" id="pause-audit-btn">
                        <i class="fas fa-pause"></i>
                        Pausieren
                    </button>
                </div>
            </div>
            
            <div class="audit-body">
                <div id="question-container" class="question-container">
                    <!-- Questions will be loaded here -->
                </div>
                
                <div class="audit-navigation">
                    <button class="btn btn-secondary" id="prev-question-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                        Zurück
                    </button>
                    <button class="btn btn-primary" id="next-question-btn">
                        Weiter
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="btn btn-success" id="complete-audit-btn" style="display: none;">
                        <i class="fas fa-check"></i>
                        Abschließen
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Viewer Modal -->
    <div id="pdf-viewer-modal" class="modal fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h2>PDF Vorschau</h2>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="download-pdf-btn">
                        <i class="fas fa-download"></i>
                        Herunterladen
                    </button>
                    <button class="modal-close" data-modal="pdf-viewer-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <iframe id="pdf-viewer" class="pdf-viewer"></iframe>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
        }
    </script>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="storage.js"></script>
    <script src="components.js"></script>
    <script src="audit-engine.js"></script>
    <script src="pdf-generator.js"></script>
    <script src="app.js"></script>
</body>
</html>
